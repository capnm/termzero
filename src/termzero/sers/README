Pulled from dark corners of internet.
Definitely needs to be rewritten
	-- if someone has the time to do it ;-)
